# 2025 DL Lab7: Image Generation å¯¦ä½œå ±å‘Š

## ç›®éŒ„
1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [å¯¦ä½œå…§å®¹è©³è§£](#å¯¦ä½œå…§å®¹è©³è§£)
   - [è³‡æ–™è½‰æ›ç®¡ç·š](#1-è³‡æ–™è½‰æ›ç®¡ç·š-data-transformation-pipeline)
   - [ç”Ÿæˆå™¨ä¸Šæ¡æ¨£å€å¡Š](#2-ç”Ÿæˆå™¨ä¸Šæ¡æ¨£å€å¡Š-generator-upsampling-blocks)
   - [åˆ¤åˆ¥å™¨ä¸‹æ¡æ¨£å€å¡Š](#3-åˆ¤åˆ¥å™¨ä¸‹æ¡æ¨£å€å¡Š-discriminator-downsampling-blocks)
   - [Critic (åˆ¤åˆ¥å™¨) æ›´æ–°é‚è¼¯](#4-critic-åˆ¤åˆ¥å™¨-æ›´æ–°é‚è¼¯)
   - [ç”Ÿæˆå™¨æ›´æ–°é‚è¼¯](#5-ç”Ÿæˆå™¨æ›´æ–°é‚è¼¯)
3. [æ¨¡å‹æ¶æ§‹ç¸½è¦½](#æ¨¡å‹æ¶æ§‹ç¸½è¦½)
4. [WGAN è¨“ç·´ç­–ç•¥åˆ†æ](#wgan-è¨“ç·´ç­–ç•¥åˆ†æ)
5. [è¶…åƒæ•¸è¨­å®š](#è¶…åƒæ•¸è¨­å®š)
6. [è©•ä¼°æŒ‡æ¨™](#è©•ä¼°æŒ‡æ¨™)
7. [å¯èƒ½çš„æ”¹é€²æ–¹å‘](#å¯èƒ½çš„æ”¹é€²æ–¹å‘)

---

## å°ˆæ¡ˆæ¦‚è¿°

æœ¬å°ˆæ¡ˆå¯¦ä½œäº†ä¸€å€‹åŸºæ–¼ **Wasserstein GAN (WGAN)** çš„æ·±åº¦ç”Ÿæˆæ¨¡å‹ï¼Œç”¨æ–¼åˆæˆé«˜å“è³ªçš„èŠ±å‰åœ–åƒã€‚ä½¿ç”¨ **Oxford Flowers102 è³‡æ–™é›†**ï¼Œè¨“ç·´æ¨¡å‹æ•æ‰èŠ±å‰çš„ç´°ç¯€ç‰¹å¾µå’Œè¤‡é›œç´‹ç†ï¼Œä¸¦ä½¿ç”¨ **FrÃ©chet Inception Distance (FID)** ä½œç‚ºä¸»è¦è©•ä¼°æŒ‡æ¨™ã€‚

---

## ç³»çµ±é‹ä½œæµç¨‹

### æ•´é«”æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           WGAN è¨“ç·´èˆ‡ç”Ÿæˆæµç¨‹                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: è³‡æ–™æº–å‚™                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Flowers102  â”‚â”€â”€â”€â–¶â”‚   Resize    â”‚â”€â”€â”€â–¶â”‚   Augment   â”‚â”€â”€â”€â–¶â”‚  Normalize  â”‚   â”‚
â”‚  â”‚  Dataset    â”‚    â”‚   64Ã—64     â”‚    â”‚ (HFlip 50%) â”‚    â”‚  [-1, 1]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: æ¨¡å‹åˆå§‹åŒ–                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚      Generator      â”‚              â”‚    Discriminator    â”‚               â”‚
â”‚  â”‚  (ConvTranspose2d)  â”‚              â”‚      (Conv2d)       â”‚               â”‚
â”‚  â”‚   nz=100 â†’ 64Ã—64Ã—3  â”‚              â”‚   64Ã—64Ã—3 â†’ score   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚              â”‚                                  â”‚                           â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ weights_init() â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                        (Normal Distribution)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: è¨“ç·´è¿´åœˆ (500 Epochs)                                              â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  For each batch:                                                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Step 1: æ›´æ–° Critic (Ã—5 æ¬¡)                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚
â”‚  â”‚  â”‚ Real Images â”‚â”€â”€â–¶ D(x) â”€â”€â–¶ mean â”€â”€â–¶â”‚  errD_real  â”‚                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚  â”‚                                             â”‚                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”           â”‚                        â”‚   â”‚
â”‚  â”‚  â”‚Noise â”‚â”€â”€â”€â–¶â”‚  G  â”‚â”€â”€â”€â–¶â”‚ Fake â”‚â”€â”€â–¶ D(G(z))â”‚â”€â”€â–¶ mean â”€â”€â–¶ errD_fake  â”‚   â”‚
â”‚  â”‚  â”‚ z~N  â”‚    â”‚     â”‚    â”‚Imagesâ”‚           â”‚                        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜           â–¼                        â”‚   â”‚
â”‚  â”‚                              errD = -errD_real + errD_fake           â”‚   â”‚
â”‚  â”‚                                           â”‚                          â”‚   â”‚
â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚                              â”‚    Weight Clipping      â”‚             â”‚   â”‚
â”‚  â”‚                              â”‚   [-0.01, 0.01]         â”‚             â”‚   â”‚
â”‚  â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Step 2: æ›´æ–° Generator (Ã—1 æ¬¡)                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”                         â”‚   â”‚
â”‚  â”‚  â”‚Noise â”‚â”€â”€â”€â–¶â”‚  G  â”‚â”€â”€â”€â–¶â”‚ Fake â”‚â”€â”€â”€â–¶â”‚  D  â”‚â”€â”€â”€â–¶ -mean(D(G(z)))      â”‚   â”‚
â”‚  â”‚  â”‚ z~N  â”‚    â”‚     â”‚    â”‚Imagesâ”‚    â”‚     â”‚      = errG             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 4: æ¨¡å‹å„²å­˜                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Generator_weights   â”‚              â”‚Discriminator_weightsâ”‚               â”‚
â”‚  â”‚       .pth          â”‚              â”‚        .pth         â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 5: åœ–åƒç”Ÿæˆèˆ‡è©•ä¼°                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Random Noise  â”‚â”€â”€â”€â–¶â”‚  Generator  â”‚â”€â”€â”€â–¶â”‚ 8189 Fake   â”‚â”€â”€â”€â–¶â”‚    FID     â”‚  â”‚
â”‚  â”‚ (8189, 100)  â”‚    â”‚  (eval)     â”‚    â”‚   Images    â”‚    â”‚ Calculationâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚          â”‚
â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                               â–¼                             â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                                    â”‚ Compare with Real  â”‚                   â”‚
â”‚                                    â”‚ Flowers102 Dataset â”‚                   â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è©³ç´°é‹ä½œæ­¥é©Ÿ

#### ğŸ“Œ Phase 1: è³‡æ–™æº–å‚™

```
Oxford Flowers102 (train + test + val)
         â”‚
         â–¼ ConcatDataset
    8189 å¼µåŸå§‹åœ–åƒ
         â”‚
         â–¼ transforms.Compose
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ Resize  â”‚â”€â”€â–¶ çµ±ä¸€å°ºå¯¸ç‚º 64Ã—64
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ RandomHFlip(0.5)â”‚â”€â”€â–¶ 50% æ©Ÿç‡æ°´å¹³ç¿»è½‰ (è³‡æ–™å¢å¼·)
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ToTensor   â”‚â”€â”€â–¶ [0, 255] â†’ [0, 1]
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Normalize(0.5, 0.5) â”‚â”€â”€â–¶ [0, 1] â†’ [-1, 1]
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    DataLoader (batch_size=256, shuffle=True)
```

#### ğŸ“Œ Phase 2: æ¨¡å‹åˆå§‹åŒ–

```
weights_init() å‡½æ•¸
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å·ç©å±¤ (Conv/ConvTranspose):          â”‚
â”‚   weight ~ N(0, 0.02)                 â”‚
â”‚                                       â”‚
â”‚ æ‰¹æ­£è¦åŒ–å±¤ (BatchNorm):                â”‚
â”‚   weight ~ N(1.0, 0.02)               â”‚
â”‚   bias = 0                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ“Œ Phase 3: å–®æ¬¡è¨“ç·´è¿­ä»£

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           ä¸€æ¬¡ Batch è¨“ç·´                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                                       â”‚
            â–¼                                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Critic æ›´æ–° (Ã—5)       â”‚                           â”‚   Generator æ›´æ–° (Ã—1)    â”‚
â”‚                         â”‚                           â”‚                         â”‚
â”‚ 1. netD.zero_grad()     â”‚                           â”‚ 1. å‡çµ D çš„æ¢¯åº¦          â”‚
â”‚                         â”‚                           â”‚                         â”‚
â”‚ 2. Real â†’ D(x)          â”‚                           â”‚ 2. netG.zero_grad()     â”‚
â”‚    errD_real = mean     â”‚                           â”‚                         â”‚
â”‚                         â”‚                           â”‚ 3. z â†’ G(z) â†’ D(G(z))   â”‚
â”‚ 3. z â†’ G(z) â†’ D(G(z))   â”‚                           â”‚    errG = -mean         â”‚
â”‚    errD_fake = mean     â”‚                           â”‚                         â”‚
â”‚                         â”‚                           â”‚ 4. errG.backward()      â”‚
â”‚ 4. errD = -real + fake  â”‚                           â”‚                         â”‚
â”‚                         â”‚                           â”‚ 5. optimizerG.step()    â”‚
â”‚ 5. errD.backward()      â”‚                           â”‚                         â”‚
â”‚                         â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ 6. optimizerD.step()    â”‚
â”‚                         â”‚
â”‚ 7. Weight Clipping      â”‚
â”‚    [-0.01, 0.01]        â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ“Œ Phase 4 & 5: ç”Ÿæˆèˆ‡è©•ä¼°

```
è¨“ç·´å®Œæˆ
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å„²å­˜æ¨¡å‹æ¬Šé‡     â”‚
â”‚  Generator.pth   â”‚
â”‚  Discriminator   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆè©•ä¼°åœ–åƒ                              â”‚
â”‚                                          â”‚
â”‚  noise = randn(8189, 100, 1, 1)          â”‚
â”‚       â”‚                                  â”‚
â”‚       â–¼                                  â”‚
â”‚  fake = netG(noise)  â”€â”€â–¶  8189 å¼µ 64Ã—64  â”‚
â”‚       â”‚                                  â”‚
â”‚       â–¼                                  â”‚
â”‚  åæ­£è¦åŒ–: [-1,1] â†’ [0,1]                 â”‚
â”‚       â”‚                                  â”‚
â”‚       â–¼                                  â”‚
â”‚  å„²å­˜ç‚º JPEG: ./GENIMG/fake*.jpg         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           FID è¨ˆç®—æµç¨‹                    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Real Images â”‚    â”‚ Generated Imgs â”‚   â”‚
â”‚  â”‚  (8189)    â”‚    â”‚    (8189)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚                   â”‚            â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                  â–¼                      â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚  Inception V3   â”‚              â”‚
â”‚        â”‚ Feature Extract â”‚              â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                 â”‚                       â”‚
â”‚                 â–¼                       â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚ Î¼_r, Î£_r        â”‚              â”‚
â”‚        â”‚ Î¼_g, Î£_g        â”‚              â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                 â”‚                       â”‚
â”‚                 â–¼                       â”‚
â”‚   FID = ||Î¼_r - Î¼_g||Â² +                â”‚
â”‚         Tr(Î£_r + Î£_g - 2âˆš(Î£_rÂ·Î£_g))    â”‚
â”‚                 â”‚                       â”‚
â”‚                 â–¼                       â”‚
â”‚         result.csv (æäº¤ Kaggle)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™æµæ‘˜è¦è¡¨

| éšæ®µ | è¼¸å…¥ | è™•ç† | è¼¸å‡º |
|-----|------|------|------|
| è³‡æ–™è¼‰å…¥ | Flowers102 åŸå§‹åœ–åƒ | Resize + Augment + Normalize | 64Ã—64 å¼µé‡ [-1,1] |
| Generator Forward | z âˆˆ â„^{100} | 4å±¤è½‰ç½®å·ç©ä¸Šæ¡æ¨£ | 64Ã—64Ã—3 åœ–åƒ |
| Discriminator Forward | 64Ã—64Ã—3 åœ–åƒ | 4å±¤å·ç©ä¸‹æ¡æ¨£ | å–®ä¸€åˆ†æ•¸ |
| Critic Loss | D(x), D(G(z)) | -mean(real) + mean(fake) | Wassersteinè·é›¢ä¼°è¨ˆ |
| Generator Loss | D(G(z)) | -mean(D(G(z))) | æœ€å¤§åŒ–åˆ¤åˆ¥å™¨åˆ†æ•¸ |
| FID è©•ä¼° | çœŸå¯¦/ç”Ÿæˆåœ–åƒé›† | Inception V3 ç‰¹å¾µæ¯”å° | FID åˆ†æ•¸ |

---

## å¯¦ä½œå…§å®¹è©³è§£

### 1. è³‡æ–™è½‰æ›ç®¡ç·š (Data Transformation Pipeline)

**ä½ç½®ï¼š** è³‡æ–™è¼‰å…¥å€å¡Š

```python
transform = transforms.Compose([
    transforms.Resize((image_size, image_size)),  # èª¿æ•´ç‚º 64x64
    transforms.RandomHorizontalFlip(p=0.5),        # éš¨æ©Ÿæ°´å¹³ç¿»è½‰
    transforms.ToTensor(),                          # è½‰æ›ç‚ºå¼µé‡
    transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5)),  # æ­£è¦åŒ–åˆ° [-1, 1]
])
```

**å¯¦ä½œèªªæ˜ï¼š**
| è½‰æ›æ­¥é©Ÿ | åŠŸèƒ½èªªæ˜ |
|---------|---------|
| `Resize((64, 64))` | å°‡æ‰€æœ‰åœ–åƒçµ±ä¸€èª¿æ•´ç‚º 64Ã—64 åƒç´ ï¼Œç¢ºä¿è¼¸å…¥å°ºå¯¸ä¸€è‡´æ€§ |
| `RandomHorizontalFlip(p=0.5)` | ä»¥ 50% æ©Ÿç‡éš¨æ©Ÿæ°´å¹³ç¿»è½‰åœ–åƒï¼Œå¢åŠ è³‡æ–™å¤šæ¨£æ€§ï¼Œé˜²æ­¢éæ“¬åˆ |
| `ToTensor()` | å°‡ PIL åœ–åƒè½‰æ›ç‚º PyTorch å¼µé‡ï¼Œåƒç´ å€¼ç¯„åœ [0, 1] |
| `Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))` | å°‡åƒç´ å€¼æ­£è¦åŒ–åˆ° [-1, 1] ç¯„åœï¼Œé…åˆç”Ÿæˆå™¨ Tanh è¼¸å‡º |

**æ•¸å­¸åŸç†ï¼š**
$$x_{normalized} = \frac{x - 0.5}{0.5} = 2x - 1$$

ä½¿å¾— $x \in [0, 1] \rightarrow x_{normalized} \in [-1, 1]$

---

### 2. ç”Ÿæˆå™¨ä¸Šæ¡æ¨£å€å¡Š (Generator Upsampling Blocks)

**ä½ç½®ï¼š** `Generator` é¡åˆ¥

```python
# State size: (ngf*8) x 4 x 4 -> (ngf*4) x 8 x 8
nn.ConvTranspose2d(ngf * 8, ngf * 4, 4, 2, 1, bias=False),
nn.BatchNorm2d(ngf * 4),
nn.ReLU(True),

# State size: (ngf*4) x 8 x 8 -> (ngf*2) x 16 x 16
nn.ConvTranspose2d(ngf * 4, ngf * 2, 4, 2, 1, bias=False),
nn.BatchNorm2d(ngf * 2),
nn.ReLU(True),

# State size: (ngf*2) x 16 x 16 -> (ngf) x 32 x 32
nn.ConvTranspose2d(ngf * 2, ngf, 4, 2, 1, bias=False),
nn.BatchNorm2d(ngf),
nn.ReLU(True),
```

**ç‰¹å¾µåœ–å°ºå¯¸è®ŠåŒ–ï¼š**

| å±¤æ¬¡ | è¼¸å…¥å°ºå¯¸ | è¼¸å‡ºå°ºå¯¸ | é€šé“æ•¸è®ŠåŒ– |
|-----|---------|---------|-----------|
| åˆå§‹å±¤ | 1Ã—1 | 4Ã—4 | nz (100) â†’ ngfÃ—8 (512) |
| ä¸Šæ¡æ¨£ 1 | 4Ã—4 | 8Ã—8 | 512 â†’ 256 |
| ä¸Šæ¡æ¨£ 2 | 8Ã—8 | 16Ã—16 | 256 â†’ 128 |
| ä¸Šæ¡æ¨£ 3 | 16Ã—16 | 32Ã—32 | 128 â†’ 64 |
| è¼¸å‡ºå±¤ | 32Ã—32 | 64Ã—64 | 64 â†’ 3 (RGB) |

**è½‰ç½®å·ç©è¼¸å‡ºå°ºå¯¸å…¬å¼ï¼š**
$$H_{out} = (H_{in} - 1) \times stride - 2 \times padding + kernel\_size$$

å°æ–¼ `ConvTranspose2d(*, *, 4, 2, 1)`ï¼š
$$H_{out} = (H_{in} - 1) \times 2 - 2 \times 1 + 4 = 2H_{in}$$

**è¨­è¨ˆè€ƒé‡ï¼š**
- ä½¿ç”¨ **ReLU** æ¿€æ´»å‡½æ•¸å¢åŠ éç·šæ€§
- **BatchNorm** ç©©å®šè¨“ç·´éç¨‹ï¼ŒåŠ é€Ÿæ”¶æ–‚
- é€æ­¥ä¸Šæ¡æ¨£é¿å…æ£‹ç›¤æ•ˆæ‡‰ (checkerboard artifacts)

---

### 3. åˆ¤åˆ¥å™¨ä¸‹æ¡æ¨£å€å¡Š (Discriminator Downsampling Blocks)

**ä½ç½®ï¼š** `Discriminator` é¡åˆ¥

```python
# State size: (ndf) x 32 x 32 -> (ndf*2) x 16 x 16
nn.Conv2d(ndf, ndf * 2, 4, 2, 1, bias=False),
nn.BatchNorm2d(ndf * 2),
nn.LeakyReLU(0.2, inplace=True),

# State size: (ndf*2) x 16 x 16 -> (ndf*4) x 8 x 8
nn.Conv2d(ndf * 2, ndf * 4, 4, 2, 1, bias=False),
nn.BatchNorm2d(ndf * 4),
nn.LeakyReLU(0.2, inplace=True),

# State size: (ndf*4) x 8 x 8 -> (ndf*8) x 4 x 4
nn.Conv2d(ndf * 4, ndf * 8, 4, 2, 1, bias=False),
nn.BatchNorm2d(ndf * 8),
nn.LeakyReLU(0.2, inplace=True),
```

**ç‰¹å¾µåœ–å°ºå¯¸è®ŠåŒ–ï¼š**

| å±¤æ¬¡ | è¼¸å…¥å°ºå¯¸ | è¼¸å‡ºå°ºå¯¸ | é€šé“æ•¸è®ŠåŒ– |
|-----|---------|---------|-----------|
| åˆå§‹å±¤ | 64Ã—64 | 32Ã—32 | 3 â†’ 64 |
| ä¸‹æ¡æ¨£ 1 | 32Ã—32 | 16Ã—16 | 64 â†’ 128 |
| ä¸‹æ¡æ¨£ 2 | 16Ã—16 | 8Ã—8 | 128 â†’ 256 |
| ä¸‹æ¡æ¨£ 3 | 8Ã—8 | 4Ã—4 | 256 â†’ 512 |
| è¼¸å‡ºå±¤ | 4Ã—4 | 1Ã—1 | 512 â†’ 1 |

**å·ç©è¼¸å‡ºå°ºå¯¸å…¬å¼ï¼š**
$$H_{out} = \lfloor \frac{H_{in} + 2 \times padding - kernel\_size}{stride} \rfloor + 1$$

å°æ–¼ `Conv2d(*, *, 4, 2, 1)`ï¼š
$$H_{out} = \lfloor \frac{H_{in} + 2 - 4}{2} \rfloor + 1 = \frac{H_{in}}{2}$$

**è¨­è¨ˆè€ƒé‡ï¼š**
- ä½¿ç”¨ **LeakyReLU(0.2)** é¿å…ç¥ç¶“å…ƒæ­»äº¡å•é¡Œ
- èˆ‡ç”Ÿæˆå™¨å‘ˆå°ç¨±çµæ§‹ï¼Œå½¢æˆç·¨ç¢¼å™¨-è§£ç¢¼å™¨æ¶æ§‹

---

### 4. Critic (åˆ¤åˆ¥å™¨) æ›´æ–°é‚è¼¯

**ä½ç½®ï¼š** è¨“ç·´è¿´åœˆ

```python
for _ in range(n_critic):  # n_critic = 5
    netD.zero_grad()
    
    # çœŸå¯¦åœ–åƒå‰å‘å‚³æ’­
    real_cpu = data[0].to(device)
    b_size = real_cpu.size(0)
    output_real = netD(real_cpu).view(-1)
    errD_real = output_real.mean()
    
    # ç”Ÿæˆå‡åœ–åƒ
    noise = torch.randn(b_size, nz, 1, 1, device=device)
    fake = netG(noise)
    
    # å‡åœ–åƒå‰å‘å‚³æ’­
    output_fake = netD(fake.detach()).view(-1)
    errD_fake = output_fake.mean()
    
    # Wasserstein æå¤±è¨ˆç®—
    errD = -errD_real + errD_fake
    errD.backward()
    optimizerD.step()
    
    # æ¬Šé‡è£å‰ª
    for p in netD.parameters():
        p.data.clamp_(-clip_value, clip_value)  # clip_value = 0.01
```

**WGAN Critic æå¤±å‡½æ•¸ï¼š**
$$\mathcal{L}_D = -\mathbb{E}_{x \sim p_{data}}[D(x)] + \mathbb{E}_{z \sim p_z}[D(G(z))]$$

**é—œéµå¯¦ä½œè¦é»ï¼š**

| è¦é» | èªªæ˜ |
|-----|------|
| `n_critic = 5` | æ¯æ›´æ–°ä¸€æ¬¡ç”Ÿæˆå™¨å‰ï¼Œæ›´æ–° 5 æ¬¡åˆ¤åˆ¥å™¨ï¼Œç¢ºä¿ Critic å……åˆ†è¨“ç·´ |
| `fake.detach()` | é˜»æ–·æ¢¯åº¦å‚³æ’­åˆ°ç”Ÿæˆå™¨ï¼Œé¿å…è¨ˆç®—ç”Ÿæˆå™¨æ¢¯åº¦ |
| `weight clipping` | å°‡æ¬Šé‡é™åˆ¶åœ¨ [-0.01, 0.01]ï¼Œå¼·åˆ¶ Lipschitz ç´„æŸ |
| `RMSprop` å„ªåŒ–å™¨ | WGAN è«–æ–‡æ¨è–¦ä½¿ç”¨ï¼Œæ¯” Adam æ›´ç©©å®š |

---

### 5. ç”Ÿæˆå™¨æ›´æ–°é‚è¼¯

**ä½ç½®ï¼š** è¨“ç·´è¿´åœˆ

```python
for p in netD.parameters():
    p.requires_grad = False  # å‡çµåˆ¤åˆ¥å™¨åƒæ•¸

netG.zero_grad()

# ç”Ÿæˆå‡åœ–åƒ
noise = torch.randn(b_size, nz, 1, 1, device=device)
fake = netG(noise)

# è¨ˆç®—ç”Ÿæˆå™¨æå¤±
output = netD(fake).view(-1)
errG = -output.mean()
errG.backward()
optimizerG.step()
```

**WGAN Generator æå¤±å‡½æ•¸ï¼š**
$$\mathcal{L}_G = -\mathbb{E}_{z \sim p_z}[D(G(z))]$$

**é—œéµå¯¦ä½œè¦é»ï¼š**

| è¦é» | èªªæ˜ |
|-----|------|
| `p.requires_grad = False` | å‡çµåˆ¤åˆ¥å™¨åƒæ•¸ï¼Œåªæ›´æ–°ç”Ÿæˆå™¨ |
| `-output.mean()` | æœ€å¤§åŒ– D(G(z))ï¼Œå³æœ€å°åŒ– -D(G(z)) |
| ç„¡ `detach()` | éœ€è¦è¨ˆç®—æ¢¯åº¦ä»¥æ›´æ–°ç”Ÿæˆå™¨ |

---

## æ¨¡å‹æ¶æ§‹ç¸½è¦½

### ç”Ÿæˆå™¨ (Generator)
```
Input: z âˆˆ â„^{100Ã—1Ã—1}
    â†“ ConvTranspose2d(100, 512, 4, 1, 0) + BN + ReLU
Feature Map: 512 Ã— 4 Ã— 4
    â†“ ConvTranspose2d(512, 256, 4, 2, 1) + BN + ReLU
Feature Map: 256 Ã— 8 Ã— 8
    â†“ ConvTranspose2d(256, 128, 4, 2, 1) + BN + ReLU
Feature Map: 128 Ã— 16 Ã— 16
    â†“ ConvTranspose2d(128, 64, 4, 2, 1) + BN + ReLU
Feature Map: 64 Ã— 32 Ã— 32
    â†“ ConvTranspose2d(64, 3, 4, 2, 1) + Tanh
Output: 3 Ã— 64 Ã— 64
```

### åˆ¤åˆ¥å™¨ (Discriminator)
```
Input: x âˆˆ â„^{3Ã—64Ã—64}
    â†“ Conv2d(3, 64, 4, 2, 1) + LeakyReLU(0.2)
Feature Map: 64 Ã— 32 Ã— 32
    â†“ Conv2d(64, 128, 4, 2, 1) + BN + LeakyReLU(0.2)
Feature Map: 128 Ã— 16 Ã— 16
    â†“ Conv2d(128, 256, 4, 2, 1) + BN + LeakyReLU(0.2)
Feature Map: 256 Ã— 8 Ã— 8
    â†“ Conv2d(256, 512, 4, 2, 1) + BN + LeakyReLU(0.2)
Feature Map: 512 Ã— 4 Ã— 4
    â†“ Conv2d(512, 1, 4, 1, 0) + Sigmoid
Output: 1 Ã— 1 Ã— 1
```

---

## WGAN è¨“ç·´ç­–ç•¥åˆ†æ

### èˆ‡åŸå§‹ GAN çš„å·®ç•°

| ç‰¹æ€§ | åŸå§‹ GAN | WGAN (æœ¬å¯¦ä½œ) |
|-----|---------|--------------|
| æå¤±å‡½æ•¸ | Binary Cross-Entropy | Wasserstein Distance |
| åˆ¤åˆ¥å™¨è¼¸å‡º | Sigmoid (æ©Ÿç‡) | ç„¡ç´„æŸ (åˆ†æ•¸) |
| å„ªåŒ–å™¨ | Adam | RMSprop |
| è¨“ç·´ç©©å®šæ€§ | å®¹æ˜“æ¨¡å¼å´©å¡Œ | æ›´ç©©å®š |
| Lipschitz ç´„æŸ | ç„¡ | Weight Clipping |

### Wasserstein è·é›¢å„ªå‹¢

1. **é€£çºŒæ€§ï¼š** å³ä½¿åˆ†ä½ˆä¸é‡ç–Šï¼Œæ¢¯åº¦ä»æœ‰æ„ç¾©
2. **ç©©å®šæ€§ï¼š** é¿å…æ¢¯åº¦æ¶ˆå¤±å•é¡Œ
3. **å¯è§£é‡‹æ€§ï¼š** æå¤±å€¼èˆ‡ç”Ÿæˆå“è³ªç›¸é—œ

---

## è¶…åƒæ•¸è¨­å®š

| åƒæ•¸ | å€¼ | èªªæ˜ |
|-----|-----|-----|
| `batch_size` | 256 | æ‰¹æ¬¡å¤§å° |
| `image_size` | 64 | åœ–åƒå°ºå¯¸ |
| `nz` | 100 | æ½›åœ¨å‘é‡ç¶­åº¦ |
| `ngf` | 64 | ç”Ÿæˆå™¨ç‰¹å¾µåœ–åŸºæº–é€šé“æ•¸ |
| `ndf` | 64 | åˆ¤åˆ¥å™¨ç‰¹å¾µåœ–åŸºæº–é€šé“æ•¸ |
| `num_epochs` | 500 | è¨“ç·´é€±æœŸæ•¸ |
| `lr` | 0.0001 | å­¸ç¿’ç‡ |
| `n_critic` | 5 | Critic æ›´æ–°æ¬¡æ•¸æ¯”ä¾‹ |
| `clip_value` | 0.01 | æ¬Šé‡è£å‰ªç¯„åœ |

---

## è©•ä¼°æŒ‡æ¨™

### FrÃ©chet Inception Distance (FID)

FID é€éæ¯”è¼ƒçœŸå¯¦åœ–åƒå’Œç”Ÿæˆåœ–åƒåœ¨ Inception V3 ç‰¹å¾µç©ºé–“ä¸­çš„åˆ†ä½ˆå·®ç•°ä¾†è©•ä¼°ç”Ÿæˆå“è³ªã€‚

$$FID = ||\mu_r - \mu_g||^2 + Tr(\Sigma_r + \Sigma_g - 2(\Sigma_r \Sigma_g)^{1/2})$$

å…¶ä¸­ï¼š
- $\mu_r, \Sigma_r$ï¼šçœŸå¯¦åœ–åƒçš„ç‰¹å¾µå‡å€¼å’Œå”æ–¹å·®
- $\mu_g, \Sigma_g$ï¼šç”Ÿæˆåœ–åƒçš„ç‰¹å¾µå‡å€¼å’Œå”æ–¹å·®

**FID åˆ†æ•¸è§£è®€ï¼š**
- **è¶Šä½è¶Šå¥½**
- 0 è¡¨ç¤ºå®Œç¾åŒ¹é…
- é€šå¸¸ < 50 è¢«èªç‚ºæ˜¯è‰¯å¥½çš„ç”Ÿæˆå“è³ª

---

## å¯èƒ½çš„æ”¹é€²æ–¹å‘

### 1. ä½¿ç”¨ WGAN-GP å–ä»£ Weight Clipping
```python
# Gradient Penalty å¯¦ä½œ
gradient_penalty = compute_gradient_penalty(netD, real, fake)
errD = -errD_real + errD_fake + lambda_gp * gradient_penalty
```

**å„ªé»ï¼š**
- æ›´æœ‰æ•ˆåœ°å¼·åˆ¶ Lipschitz ç´„æŸ
- é¿å…æ¬Šé‡è£å‰ªå°è‡´çš„å®¹é‡é™åˆ¶

### 2. å¢åŠ è³‡æ–™å¢å¼·
```python
transforms.RandomRotation(15),
transforms.ColorJitter(brightness=0.2, contrast=0.2),
transforms.RandomAffine(degrees=0, translate=(0.1, 0.1)),
```

### 3. ä½¿ç”¨æ›´æ·±å±¤çš„ç¶²è·¯æ¶æ§‹
- åŠ å…¥ **Self-Attention** æ©Ÿåˆ¶
- ä½¿ç”¨ **Spectral Normalization**
- æ¡ç”¨ **Progressive Growing** ç­–ç•¥

### 4. èª¿æ•´è¶…åƒæ•¸
- å˜—è©¦ä¸åŒçš„ `n_critic` å€¼ (3-10)
- èª¿æ•´å­¸ç¿’ç‡æ’ç¨‹
- ä½¿ç”¨ Adam å„ªåŒ–å™¨é…åˆ Î²1=0, Î²2=0.9

---

## çµè«–

æœ¬å¯¦ä½œæˆåŠŸå®Œæˆäº†åŸºæ–¼ WGAN çš„èŠ±å‰åœ–åƒç”Ÿæˆæ¨¡å‹ï¼Œæ¶µè“‹äº†ï¼š

1. âœ… å®Œæ•´çš„è³‡æ–™é è™•ç†ç®¡ç·š
2. âœ… DCGAN æ¶æ§‹çš„ç”Ÿæˆå™¨å’Œåˆ¤åˆ¥å™¨
3. âœ… WGAN è¨“ç·´ç­–ç•¥ï¼ˆWasserstein Loss + Weight Clippingï¼‰
4. âœ… FID è©•ä¼°æ©Ÿåˆ¶

æ¨¡å‹é€é 500 å€‹ epoch çš„è¨“ç·´ï¼Œå­¸ç¿’ Oxford Flowers102 è³‡æ–™é›†çš„åˆ†ä½ˆç‰¹å¾µï¼Œä¸¦èƒ½ç”Ÿæˆ 64Ã—64 è§£æåº¦çš„èŠ±å‰åœ–åƒã€‚

---

*å ±å‘Šç”Ÿæˆæ—¥æœŸï¼š2025å¹´12æœˆ5æ—¥*
